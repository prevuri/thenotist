%div{:'ng-controller' => 'NoteCtrl', :'ng-init' => "init()"}
  
  %link{:'ng-repeat' => 'css_file in note.uploaded_css_files', :type => "text/css", :rel => "stylesheet", :'ng-href' => "{{css_file.public_path}}"}

  #note-header
    %h1.note-title  {{note.title}}
    .note-description {{note.description}}
    .page-number
      .pages
        /TODO make dynamic
        Page
        %span
          1 
        of 4
      .profile-container.circular.prev-page
        %i.icon-angle-left
      .profile-container.circular.next-page
        %i.icon-angle-right
      .profile-container.circular.flag
        %i.icon-exclamation
    .contributors
      .profile-container.circular.share-note
        %i.icon-plus
      .profile-container.circular{:'ng-repeat' => 'contrib in note.contributors'}
        %img.profile-image.circular{:'ng-src' => 'contrib.user.user_fb_data.profile_image'}

  #note-main
    .note-pages
      .page{:'ng-repeat' => 'file in note.uploaded_html_files'}
        .file-container{:'ng-init' => "getComments(file.id, $index)"}
          .page-container
            %a{ :name => "Page-{{file.page_number}}"}
            .note-page{:'file-id' => '{{file.id}}'}  
              %div{:'ng-include' => 'file.trusted_path'}
        .comment-buttons-container  
          .comment-button{:'ng-repeat' => "comment in file.comments", :line_id => "{{comment.line_id}}", :'ng-click' => 'expandCommentLine(comment.line_id)', :'ng-style' => "{top: commentY(comment.line_id)+'px'}"}
            %i.icon-comments
          .comment-button#new-comment-button
            %i.icon-comments
        .comments-container
          .comments
            %ng-include{:src => '"/assets/comments.html"'}
    #new-comment-panel.comment{:'ng-show' => 'showNewComment', :'ng-style' => "{'top': newCommentY+'px' }"}
      .comment-inner
        .profile-container.circular
          .profile-image.circular{:'ng-style' => "{background: 'url(' + currentUser.user_fb_data.profile_image + ') no-repeat'}"}
        .comment-body
          .user
            .name
              {{currentUser.name}}
          .comment-text
            %input#newcomment.new_comment_text_field{:type => 'textarea', :placeholder => 'Enter your comment here', :'ng-model' => 'newCommentText'}
        .bottom
          %a.new-comment-cancel.text-link{:'ng-click' => 'showNewComment = false'}
            Cancel
          %a.new-comment-submit.text-link{:'ng-click' => 'submitParentComment($index)'}
            Submit
        .clear